jQuery(AmpelPluginRenderer);
function AmpelPluginRenderer(h){function l(c){"undefined"!==typeof console&&console.log&&console.log(c)}function u(c,a){void 0===a&&(a="");return r[c]+a+r[4]}function w(c,a){return'<span style="color: '+a+'">'+c+"</span>"}function E(c){var a=null;try{var b=/(\d\d?)\.(\d\d?)\.(\d{2,4})?/.exec(c);if(null===b)if(b=/(\d\d?) (\w{3}) (\d{2,4})/.exec(c),null!==b){for(var e=b[2],d="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec err".split(" "),h=0,f=0;f<d.length;f++)if(e==d[f]){e=f;h=1;break}if(0==h)return null;
a=new Date(b[3],e,b[1],23,59)}else return null;else{if(void 0===b[3]||""===b[3])b[3]=y.getFullYear();2E3>b[3]&&(b[3]=Number(b[3])+2E3);a=new Date(b[3],b[2]-1,b[1],23,59)}}catch(g){return l("Error while parsing date '"+c+"': "+g),null}return a}if("object"===typeof AmpelData&&void 0!==AmpelData.length&&0!=AmpelData.length){var y=new Date,d;d=AmpelData[0];if("string"!=typeof d)l("No puburlpath!");else{var r=["<img src='"+d+"/System/FamFamFamSilkIcons/tick.png' alt='' title='","<img src='"+d+"/System/AmpelPlugin/images/ampel_g.gif' alt='' title='",
"<img src='"+d+"/System/AmpelPlugin/images/ampel_o.gif' alt='' title='","<img src='"+d+"/System/AmpelPlugin/images/ampel_r.gif' alt='' title='","'>"];for(d=1;d<AmpelData.length;d++){var z=AmpelData[d];h(z.css).livequery(function(c){return function(){a:{var a=h(this),b=c.wcheck,e=c.dcheck,d=c.done,x=c.warn,f=c.termin,g=c.dst,m=c.mode,p=c.css;if("string"!=typeof p||""==p||"string"!=typeof g||""==g||"number"!=typeof x)l("Necessary fields not found!");else{var A=null;""!=b&&(A=RegExp(b,"i"));"best"==
m?m=!0:(0!==m.length&&"worst"!=m&&l("Unknown mode: '"+m+"' in light: '"+p+"'"),m=!1);a=a[0];if("DIV"==a.tagName.toUpperCase())if(a=a.getElementsByTagName("table"),0!=a.length)a=a[0];else{l("No table found in div with '"+p+"'!");break a}a=a.rows;if(void 0===a||void 0===a.length||0==a.length)l("Table seems to be empty: "+p);else{var B=a[0],s=b=-1,v=-1,C=!1;""!=d&&""!=e&&(C=RegExp(e,"i"));for(e=0;e<B.cells.length;e++){var t=B.cells[e].textContent||B.cells[e].innerText,t=h.trim(t);t==g&&(s=e);t==f&&(b=
e);!1!=C&&t==d&&(v=e)}if(-1==b||-1==s)l("Light with '"+p+"': Column for date, or destination not found!");else try{for(d=1;d<a.length;d++){var f=null,k=a[d],g="";if(void 0!==k.cells){if(0<v&&(g=h.trim(k.cells[v].textContent||k.cells[v].innerText),C.test(g))){k.cells[s].innerHTML=u(0,g);continue}for(var g=h.trim(k.cells[b].innerHTML),r=g.split(";"),e=0;e<r.length;e++){var q=E(r[e]);null!=q&&(null===f?f=q:m?f.getTime()<q.getTime()&&(f=q):f.getTime()>q.getTime()&&(f=q))}null!=A&&A.test(g)&&(f=y);if(null!==
f){var n=(f.getTime()-y.getTime())/864E5;if("1"==c.hidden||"true"==c.hidden){var D=h.trim(k.cells[b].innerHTML);k.cells[s].innerHTML=0>n?w(D,"red"):n<=x?w(D,"orange"):w(D,"green")}else k.cells[s].innerHTML=0>n?u(3,"schon "+Math.floor(-n)+" Tage abgelaufen"):n<=x?u(2,"noch "+Math.floor(n)+" Tage"):u(1,"noch "+Math.floor(n)+" Tage")}}}}catch(z){}}}}}}(z))}}}};